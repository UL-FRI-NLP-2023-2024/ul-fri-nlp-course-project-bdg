[
    {
        "role": "user",
        "message": "Tole spodaj sprašujem kot laik, ker ne vem ali obstaja kakšna storitev na spletu kjer bi lahko našel rešitev zase. Moj stari i5 procesor je preslab za moje zahteve in se precej matra z neko obsežno xls datoteko, ki ima okoli 50.000 vrstic in kalkulacije v dveh stolpcih. En stolpec lahko obdeluje po cel dan, s tem, da je procesor neprestano na 100%. Moram pa vsak stolpec nekajkrat obdelati oz. ponoviti postopke z modifikacijami podatkov.  Ali obstaja kakšna možnost dostopa do kakšne online super zmožne virtualke ali pa kake druge storitve, kjer bi imel dostop do kakšnega veliko boljšega procesorja preko katerega bi naredil vse te kalkulacije in analize v bolj doglednem času?  Te korake moram narediti samo enkrat, se pravi teh kalkulacij ne delam neprestano ampak jih bom moral narediti samo zdaj, ampak takrat kvalitetno in primerno hitro. Zato nakup boljšega računalnika ni smiseln, pa tudi vprašanje je koliko hitrejši bi sploh bil."
    },
    {
        "role": "assistant_0",
        "message": "Koliko bi bil pripravljen za pripravljen mesečno plačevati?"
    },
    {
        "role": "assistant_1",
        "message": "Če moreš, daj najprej preverit na kakšnem novejšem CPU in z več pomnilnika, da lahko primerjaš. CPU je ena stvar, fizični pomnilnik je druga, same kalkulacije in uporabljenih funkcionalnosti tretja, uporaba drugega orodja četrta."
    },
    {
        "role": "assistant_0",
        "message": "Poglej si tole ponudbo, plačuješ po urah  https://www.scaleway.com/en/pricing/"
    },
    {
        "role": "user",
        "message": "@assistant_0: ne rabim mesečnega najema, ker tole bi s solidnim procesorjem verjetno rešil preko vikenda, če ne že celo v nekaj urah. Sem pripravljen plačati, tole na linku se zdi kar zanimivo, če se res plačuje po urah.  @gtfo: bom poskusil dobiti kaj zmogljivejšega v službi, preverim tudi to opcijo."
    },
    {
        "role": "assistant_2",
        "message": "https://www.hetzner.com/cloud je cenejsi, pa na wikiju imajo navodila kako namestiti Windows. Res pa ni trivialen proces. Se pa tudi placuje po urah. Tole je pa najlazja resitev: https://www.paperspace.com/ Dobis streznik s prednamescenim Windowsom in zelo dobrim oddaljenim namizjem (sicer primarno prilagojen za igre.)"
    },
    {
        "role": "assistant_3",
        "message": "Samo kakšne kalkulacije pa so to, da že pri skromnih 50.000 vrsticah in DVEH stolpcih predstavljajo problem?  Morda pa Excel ni optimalno orodje za te kalkulacije? Ali pa so same formule neoptimalne...?"
    },
    {
        "role": "assistant_4",
        "message": "Brezplačno preizkusi office 365 in zaposli Microsoftove strežnike. :D"
    },
    {
        "role": "assistant_5",
        "message": "@assistant_3 je 25. sep 2020 ob 22:29 izjavil:Samo kakšne kalkulacije pa so to, da že pri skromnih 50.000 vrsticah in DVEH stolpcih predstavljajo problem?  Morda pa Excel ni optimalno orodje za te kalkulacije? Ali pa so same formule neoptimalne...?  Se skoraj strinjam s tem. To je 100k formul. Naj bojo še tako \"kompleksne\", ko nebi smelo solidnemu procesorju vzeti niti ure..   Sicer pa, glede na to, da je to za službo: 1. Naj to nekako zadevo rešijo (boljši hardware (mašina za par kEUR to reši v minutah), strežnik nekje na cloudu, ki bo to zmlel v minutah) ALI 2. Če to ne gre, te pač plačujejo za to, da čakaš da računalnik nekaj zmleje. Vmes si odpreš pivo in na drugem računalniku odpreš netflix.   Res tukaj ne razumem problema.  @assistant_4 je 26. sep 2020 ob 00:56 izjavil:Brezplačno preizkusi office 365 in zaposli Microsoftove strežnike. :D  Mhm, da zaupne podatke firme microsofu in ko to ugotovijo mu rečejo pot pod noge in plačaj odškodnino za izgubljene podatke."
    },
    {
        "role": "assistant_6",
        "message": "Kakšna je pa poraba pomnilnika?  Najbrž so v formulah, kake krožne reference? Boljši hw bo najbrž nekaj prinesel v čudeže pri Excelu pa ni za računati."
    },
    {
        "role": "assistant_1",
        "message": "Ja, to vse je potrebno vedeti, ampak glede na uvod... Najlažje je sprobati na boljšem računalniku, še posebej samooklicanim laikom :)"
    },
    {
        "role": "assistant_4",
        "message": "@assistant_5 je 26. sep 2020 ob 01:06 izjavil: Mhm, da zaupne podatke firme microsofu in ko to ugotovijo mu rečejo pot pod noge in plačaj odškodnino za izgubljene podatke.  Samo res. Če najameš mašino pri xy firmi v cloudu so tvoji podatki bistveno bolj varni."
    },
    {
        "role": "assistant_7",
        "message": "Bulshit :) ce mas tok slabo masino da bogih 50.000 vrsti ne predela, potem edino kar obstaja je ali boljsi rac ali pa google sheets. Da bodo hekerji ukradl lih tvoj sheet je tok mogoče kot da zgubis rac."
    },
    {
        "role": "assistant_4",
        "message": "Najboljša odločitev je pregled in optimizacija formul. Morda prestavit podatke v acess in reševati problem z SQL-om?  OP rama imaš dovolj, da nimaš i5 + 2GB rama. :D"
    },
    {
        "role": "assistant_1",
        "message": "Dajte berite malo, no, OP je laik, sam tako trdi... In uporablja antični i5. Nadgradnja vsaj na Access (ne že kar SQL) verjetno ni smiselna v tem trenutku. (Danes sem aktiven na forumu, se mi nekaj ne da it delat, pač prokrastinacija)."
    },
    {
        "role": "assistant_8",
        "message": "50k vrstic ni nič.   To obdela že ZX spectrum v nekem normalnem času ."
    },
    {
        "role": "user",
        "message": "@assistant_5 je 26. sep 2020 ob 01:06 izjavil:@assistant_3 je 25. sep 2020 ob 22:29 izjavil:Samo kakšne kalkulacije pa so to, da že pri skromnih 50.000 vrsticah in DVEH stolpcih predstavljajo problem?  Morda pa Excel ni optimalno orodje za te kalkulacije? Ali pa so same formule neoptimalne...?  Se skoraj strinjam s tem. To je 100k formul. Naj bojo še tako \"kompleksne\", ko nebi smelo solidnemu procesorju vzeti niti ure..   - Sicer pa, glede na to, da je to za službo:   - Prvo kot prvo, tole NI za službo, to je moja privat hobi zadeva.  - Ja se strinjam, formule sigurno niso optimalne, ampak boljše zadeve ne obstajajo za Excel, sem obrnil pol forumov. Nisem pa programer, da bi znal kaj drugega sam spacati.  Formule ta trenutek ne morem pogledati, ker Excel že od včeraj zvečer obdeluje celice in je nekje na 25%.  - Brezplačni office365: koliko procesorjev pa ti dodelijo v takem primeru? Rabim nekaj kar je že postavljeno in samo gor vržem file.  - Rama imam 8gb, vse skupaj laufa na SSD.  - Ali Google sheets podpira v celoti excelove formule?"
    },
    {
        "role": "assistant_8",
        "message": "Pol imaš pa res kompleksne kalkulacije, ki si jih še malo zafrknil..."
    },
    {
        "role": "user",
        "message": "@assistant_8 je 26. sep 2020 ob 10:53 izjavil:Pol imaš pa res kompleksne kalkulacije, ki si jih še malo zafrknil...   Verjetno res, ne bom niti zanikal  @user je 26. sep 2020 ob 10:54 izjavil:@assistant_8 je 26. sep 2020 ob 10:53 izjavil:Pol imaš pa res kompleksne kalkulacije, ki si jih še malo zafrknil...   Verjetno res, ne bom niti zanikal   Formula vsebuje okoli 40 posameznih COUNTIFS sklicev, vsak sklic kaže na 40 celic s podatki (40 x 50.000 vrstic). Niti ne vem če sem prav povedal.  @user je 26. sep 2020 ob 10:54 izjavil:@assistant_8 je 26. sep 2020 ob 10:53 izjavil:Pol imaš pa res kompleksne kalkulacije, ki si jih še malo zafrknil...   Verjetno res, ne bom niti zanikal @user je 26. sep 2020 ob 10:54 izjavil:@assistant_8 je 26. sep 2020 ob 10:53 izjavil:Pol imaš pa res kompleksne kalkulacije, ki si jih še malo zafrknil...   Verjetno res, ne bom niti zanikal   Formula vsebuje okoli 40 posameznih COUNTIFS sklicev, vsak sklic kaže na celico s podatki, teh celic pa je 40 (40 x 50.000 vrstic). Niti ne vem če sem prav povedal."
    },
    {
        "role": "assistant_9",
        "message": "Office365 test, daš v online excel. Druga opcija Azure test, daš kreditno in dobiš brezplačno za €170 resource time, narediš virtualko z Win+Office. Teh €170 je precejkrat dovolj za tvoj problem.  Evo primera z Win10 OS, 8CPUjev in 56Gb za 5 ur... sitnica: Virtual Machines West Europe 1 DS13 v2 (8 vCPU(s), 56 GB RAM) x 5 Hours; Windows – (OS Only) Pay as you go; 1 managed OS disks – S4, 100 transaction units; 5 GB Bandwidth €6,03  Pa še kalkulator, da si sam zračunasš: https://azure.microsoft.com/en-us/prici..."
    },
    {
        "role": "assistant_1",
        "message": "Op, huh, pa ti imaš v redu mašinerijo, očitno.  Daj si naredit (če se izplača!!) uporabniško definirane funkcije v VBA Module, da enkapsuliraš kompleksnost in jih reusaš, brez odvečnih kopij.  To, kar najdeš na forumih in zlepiš skupaj brez programerkega ozadja, ehmmm, redko, da se izide... Recimo, uporaba ustreznih funkcionalnosti lahko spremeni izvajanje iz 6 ur na 3 minute!  Daj primer ene kalkulacije v tej tvoji matriki 40x50k=2M celic? Se ponavljajo, so različne po stolpcih, vrsticah, problemih?"
    },
    {
        "role": "user",
        "message": "gtfo: formula se ponavljajo samo na tak način, da se vsaka formula sklicuje na podatek v svoji vrstici. Popoldan preverim Google sheets in druge opcije, do takrat pa se mi upam da Excel zbudi, da pridem do formule in ti jo pošljem."
    },
    {
        "role": "assistant_4",
        "message": "Google sheets ti ne bo pomagal.  ČE je hobi naloži na 365 in poglej kaj se zgodi."
    },
    {
        "role": "assistant_1",
        "message": "Pa tvoja fizična mašina je več kot dovolj, res.  Verjetno imaš zafecljane formule - naredi jo v VBA modulu, skompajliraj in je.  Ne rabiš kopij istega po vse celicah!!"
    },
    {
        "role": "assistant_6",
        "message": "@user je 26. sep 2020 ob 11:05 izjavil:gtfo: formula se ponavljajo samo na tak način, da se vsaka formula sklicuje na podatek v svoji vrstici. Popoldan preverim Google sheets in druge opcije, do takrat pa se mi upam da Excel zbudi, da pridem do formule in ti jo pošljem.  Mirno ubij proces ker tole ne bo nikamor pripeljalo. Ni problem hw ampak tabela. Pa naslednjič imej več kopij."
    },
    {
        "role": "assistant_10",
        "message": "@user je 25. sep 2020 ob 21:12 izjavil:Tole spodaj sprašujem kot laik, ker ne vem ali obstaja kakšna storitev na spletu kjer bi lahko našel rešitev zase. Moj stari i5 procesor je preslab za moje zahteve in se precej matra z neko obsežno xls datoteko, ki ima okoli 50.000 vrstic in kalkulacije v dveh stolpcih. En stolpec lahko obdeluje po cel dan, s tem, da je procesor neprestano na 100%. Moram pa vsak stolpec nekajkrat obdelati oz. ponoviti postopke z modifikacijami podatkov.  Ali obstaja kakšna možnost dostopa do kakšne online super zmožne virtualke ali pa kake druge storitve, kjer bi imel dostop do kakšnega veliko boljšega procesorja preko katerega bi naredil vse te kalkulacije in analize v bolj doglednem času?  Te korake moram narediti samo enkrat, se pravi teh kalkulacij ne delam neprestano ampak jih bom moral narediti samo zdaj, ampak takrat kvalitetno in primerno hitro. Zato nakup boljšega računalnika ni smiseln, pa tudi vprašanje je koliko hitrejši bi sploh bil.  Povej, koliko MB ali GB ti ta excel list zavzema. Mogoče bi bila tudi rešitev, da tabelo razdeliš po listih. Lahko za vnosne podatke odpreš svoj excel zvezek, za rezultate pa več zvezkov z več listi, ki jim pač dodaš v formuli \"išči od - do\". Pa še vprašanje, ali si kdaj pa kdaj očistiš računalnik n.pr. s CCleaner-jem?"
    },
    {
        "role": "user",
        "message": "xls datoteka je velika 38mb.   CCleaner ne, uporabljam Malwarebytes in je računalnik čist kot solza :)"
    },
    {
        "role": "assistant_10",
        "message": "Ja to je kar velika datoteka. Poskusi z rešitvijo, ki sem ti jo predlagal. Jaz imam sicer datoteko veliko ca 14 MB, vendar razdeljeno po 2 - 3 MB in nimam nobenih težav.  Mogoče še nekaj, kar sem ugotovil pri sebi. Ko sem v novih windowsih odpiral excel iz windowsov 93, mi je tudi zelo dolgo mlel, potem sem ga shranil v novo verzijo, pa se je datoteka zmanjšala za kar nekaj MB."
    },
    {
        "role": "assistant_1",
        "message": "Za take velike zbirke dajte uporabit vsaj Access. Je pa res, da te (sicer enostavne) migracije ti ne more naredit ravno vsak, ki ima 2 minuti casa."
    },
    {
        "role": "assistant_11",
        "message": "Dobro jutri.  Evo, en predolg. Skopiraj ta eksel v novega, pobriši vse vrstice razen eno in poženi kalkulacije.  Se pravi, tako da imaš minimalno vrstic/podatkov, na katerih še lahko zaganjaš celotno kalkulacijo.  In potem izmeri čas.  Ko imaš to, dodaj 1, 2, 4 vrstice, in ponovno zaženi in izmeri čas.  Čisto možno, da ta tvoj program počne eno in isto stvar večkrat. Npr. da dela loop-e, kjer prvo zračuna vrednosti za vrstico 1, potem naredi loop in zračuna vrednosti za 1 in 2 vrstico, potem naredi loop in zračuna vrednosti za 1, 2 in 3 vrstico itn.   Stestiraj z minimalno podatki in poročaj."
    },
    {
        "role": "assistant_12",
        "message": "Če povzamemo situacijo, kot jo je opisal OP:   @user je 25. sep 2020 ob 21:12 izjavil:Moj stari i5 procesor je preslab za moje zahteve in se precej matra z neko obsežno xls datoteko, ki ima okoli 50.000 vrstic in kalkulacije v dveh stolpcih.     @user je 26. sep 2020 ob 11:05 izjavil:formula se ponavljajo samo na tak način, da se vsaka formula sklicuje na podatek v svoji vrstici.     @user je 26. sep 2020 ob 10:54 izjavil:Formula vsebuje okoli 40 posameznih COUNTIFS sklicev, vsak sklic kaže na 40 celic s podatki (40 x 50.000 vrstic). Niti ne vem če sem prav povedal.   je edini smiselen predlog, naj se formula razbije na več podformul oziroma uporabi več stolpcev za računanje (če je rezultat odvisen od 40 stolpcev, stavim da vse optimizacije odpadejo - čeprav ne trdim, da sicer so kakšne) in se preveri, če se kaka kalkulacija ponavlja. \"Program\" (programa sicer ni) zanesljivo nima zank ipd.  Če je formula zelo zapletena, si lahko pomagaš s kakšnimi triki, ki pa so enkratne narave oz. zahtevajo VBA za ponavljanje. Npr COUNTIF. Narediš formulo s samo enim (če je res, kar praviš, je vse v aktivni vrstici), zračunaš za vseh 50.000 vrstic, potem pa pokažeš ta stolpec in copy-paste special-values. Potem to ponoviš parkrat ( vsakić več stolpcev hkrati, iščeš ravnotežje med bednim ponavljajočim se delom in tem, da excel počepne) in na koncu imaš 40 COUNTIFov izračunanih za te podatke. Potem formulo udariš na teh podatkih."
    },
    {
        "role": "user",
        "message": "@assistant_12 je 26. sep 2020 ob 16:06 izjavil:Če povzamemo situacijo, kot jo je opisal OP: je edini smiselen predlog, naj se formula razbije na več podformul oziroma uporabi več stolpcev za računanje (če je rezultat odvisen od 40 stolpcev, stavim da vse optimizacije odpadejo - čeprav ne trdim, da sicer so kakšne) in se preveri, če se kaka kalkulacija ponavlja. \"Program\" (programa sicer ni) zanesljivo nima zank ipd.  Če je formula zelo zapletena, si lahko pomagaš s kakšnimi triki, ki pa so enkratne narave oz. zahtevajo VBA za ponavljanje. Npr COUNTIF.    Ravnokar to delam, razbijam formulo po stolpcih in za vsako celico svojo formulo. Bom videl, če bo kaj boljše.  Uporabljam COUNTIF, s tem da sem verjetno naredil napako, ker sem v isto celico vrgel countif za 40 različnih celic.... se pravi countif + countif + ..."
    },
    {
        "role": "assistant_13",
        "message": "@user je 26. sep 2020 ob 10:54 izjavil:Formula vsebuje okoli 40 posameznih COUNTIFS sklicev, vsak sklic kaže na 40 celic s podatki (40 x 50.000 vrstic). Niti ne vem če sem prav povedal.  Uporabi array formule."
    },
    {
        "role": "user",
        "message": "@reves, preverim array...  Naredil test. 100 vrstic mi zdaj, ko so formule razbite naredi v 65 sekundah. Se pravi bo rabil 11 minut za 1000 vrstic, nekje dobrih 8 ur za vseh 45500.     slikca Zadnji stolpec je SUM"
    },
    {
        "role": "assistant_14",
        "message": "Naredil test. 100 vrstic mi zdaj, ko so formule razbite naredi v 65 sekundah. Se pravi bo rabil 11 minut za 1000 vrstic, nekje dobrih 8 ur za vseh 45500.Tule nekaj smrdi :-) Saj ne delaš nekih hudih fizikalnih simulacij ali kaj podobnega. Teh par številk bi moral mlinček prežvečiti v nekaj 100 milisekundah max. Ali so tvoje formule čudne ali pa excel ni primerno orodje za tvoj problem."
    },
    {
        "role": "user",
        "message": "Sem pripel sliko malo višje, se lepo vidi da je formula čisto navaden COUNTIF, ki gleda po vseh 35 stolpcih in 50.000 vrsticah.  Prej sem se zmotil...dejansko je 35 stolpcev, ne 5 al koliko sem že rekel včeraj..."
    },
    {
        "role": "assistant_6",
        "message": "Problem je ker je tudi CD najbrž zdefiniran z nekim cointifom in potem vsakič posebej izračunava še pogoj."
    },
    {
        "role": "assistant_15",
        "message": "Katero verzijo Excela sploh imaš (2010, 2013, 2016, 2019; 32 ali 64 bit)?"
    },
    {
        "role": "assistant_14",
        "message": "Katero verzijo Excela sploh imaš (2010, 2013, 2016, 2019; 32 ali 64 bit)?Nima to neke posebne veze.  ki gleda po vseh 35 stolpcih in 50.000 vrsticahMožno je, da so celice ciklično odvisne ena od druge in potem simuliraš \"celični avtomat\" aka game-of-life :-)"
    },
    {
        "role": "assistant_15",
        "message": "Verzija lahko kar precej vpliva na hitrost...  https://docs.microsoft.com/en-us/office..."
    },
    {
        "role": "assistant_16",
        "message": "Kaj pa če bi dal kolegu, ki je malo.bolj domač s temi zadevami, za pivo in ti on reši."
    },
    {
        "role": "assistant_8",
        "message": "Dolgoročna rešitev je, da bazo skopiraš v SQLite, in narediš ustrezen query. Ali več njih..."
    },
    {
        "role": "assistant_6",
        "message": "Pa, če ne nuca dolgoročne rešitve. As gluh."
    },
    {
        "role": "user",
        "message": "@assistant_15 je 26. sep 2020 ob 19:30 izjavil:Katero verzijo Excela sploh imaš (2010, 2013, 2016, 2019; 32 ali 64 bit)?   2016, 64 bit  Celice niso ciklične. Bom poskusil še s parimi opcijami, ki ste mi jih predlagali. Žal ne morem vsega naenkrat, pa še kaj se moram prej naučit :)  Res da nisem programer, nisem pa tudi IT analfabet in se znajdem. Samo včasih se kje zataknem kot sem se v tem primeru in potem razmišljam o rešitvah kot je bila ta, da bi vse skupaj začasno preselil na nek server. Glede na vaše nasvete mi je zdaj jasno, da ni tako velik problem v HW, ampak v formulah.  Pa še naučil sem se, da je conditional formatting tudi velik problem pri obsežnih tabelah. Je vse to letelo ven :)"
    },
    {
        "role": "user",
        "message": "Dobri dve uri kasneje je rezultat tak, da nisem prišel nikamor :)  Razbijanje formul po celicah ni kaj dosti koristilo.  Array formula mi ni koristila, ali pa ne znam uporabljati prave formule.  Access mi je v osnovi vsaj malo jasen in logičen, ne vem pa kako bi to uporabil pri svojem problemu.  Se moram pa popravit. Glede na to, da je 35 stolpcev in skoraj 45000 vrstic s podatki, to znese skoraj 1.6 milijona celic. Se pravi mora vsak COUNTIF primerjati moj pogoj z vsemi temi celicami. In zato verjetno tudi vse dela tako počasi."
    },
    {
        "role": "assistant_17",
        "message": "countif ukaz gleda vsako vrstico posebej. Torej če imaš 50k vrstic pomeni da mora sprocesirat 50k×50k=2500000000 vrstic samo za ta ukaz. Reši zadevo na drugačen način."
    },
    {
        "role": "assistant_1",
        "message": "2M podatkov -> Access (ali kaj podobnega), uvoz 2M podatkov v 1 tabelo s 35 stolpcev x 45000 zapisov, count()+filter itn... Samega problema ne poznam(o), očitno orodje ni primerno za to opravilo. Dodatna pomoč je verjetno možna, vendar ne brez razumevanja naloge, vpogleda v tabelo itd. Excel očitno ni mišljen za takšne glomazne zadeve. Zakaj sploh to potrebuješ? Verjetno kaj službenega? Ne vem, zakaj bi drugače toliko časa investiral v to. Reci komu od prisotnih za pomoč, sam ne rešujem teh zadev ljubiteljsko,"
    },
    {
        "role": "assistant_17",
        "message": "Če narediš if v novo kolono in zapišeš število 0 ali vrednost, potem pa count za to kolono. Mogoče bi to delalo hitreje."
    },
    {
        "role": "assistant_4",
        "message": "Kakšen pa imaš pogoj v if?"
    },
    {
        "role": "assistant_3",
        "message": "Če je zadeva hobby narave, najbrž nebi smel biti tako skrivnosten projekt, da nebi mogel malo opisati problem, ki ga skušaš reševati?  Mogoče ti na koncu nekdo spiše 30vrstic v pythonu, ki naredijo to isto čudo v nekaj sekundah....?"
    },
    {
        "role": "assistant_10",
        "message": "Samo zanima me, zakaj te moj predlog, da tabelo razbiješ na več zvezkov, ne zanima.  En zvezek imaš lahko samo za vnos podatkov, tabelo z rezultati pa razdeliš na več zvezkov. Ko delaš, imaš lahko odprte vse zvezke, računalnik pa bo obremenjen samo z zvezkom, ki ga boš imel v obdelavi."
    },
    {
        "role": "assistant_6",
        "message": "@assistant_10 je 27. sep 2020 ob 01:26 izjavil:Samo zanima me, zakaj te moj predlog, da tabelo razbiješ na več zvezkov, ne zanima.  En zvezek imaš lahko samo za vnos podatkov, tabelo z rezultati pa razdeliš na več zvezkov. Ko delaš, imaš lahko odprte vse zvezke, računalnik pa bo obremenjen samo z zvezkom, ki ga boš imel v obdelavi.  Ker je pristop povem napačen, vsak Excel tutorial ga odsvetuje."
    },
    {
        "role": "assistant_10",
        "message": "Tega pa nisem vedel. Vseeno pri meni takšen način lepo deluje."
    },
    {
        "role": "user",
        "message": "@assistant_4 je 26. sep 2020 ob 23:46 izjavil:Kakšen pa imaš pogoj v if?  Nič posebnega ni v formuli. =(COUNTIF($A$1:$AI$45000;A1))  Štejem duplikate po vseh celicah. Zanima me kolikokrat se pojavi podatek iz A1 v vseh celicah. In potem podatek iz B1, C1, D1...AI1.  Na koncu pa seštevek vseh duplikatov v tej vrstici. In tako naprej za vsako vrstico posebej.  Je pa v celicah tekst oziroma kratice in ne številke. Mogoče ga to \"zmatra\". Ni nobena skrivnost, sej zato pa sem priložil sliko malo višje. Je čisto hobi, ni pa za službo.  Bom danes za hec tole spravil v Access.  Kdor je naveličan te teme, ne rabi odgovarjat. Sem samo vprašal za nasvet, dali ste mi jih že kar nekaj."
    },
    {
        "role": "assistant_12",
        "message": "@user je 27. sep 2020 ob 08:03 izjavil:@assistant_4 je 26. sep 2020 ob 23:46 izjavil:Kakšen pa imaš pogoj v if?  Nič posebnega ni v formuli. =(COUNTIF($A$1:$AI$45000;A1))  To in to:  @user je 26. sep 2020 ob 11:05 izjavil:gtfo: formula se ponavljajo samo na tak način, da se vsaka formula sklicuje na podatek v svoji vrstici.   ne gre skupaj. Občudujem ljudi v oddelkih podpori strankam, ki morajo take nebuloze prenašati dnevno.  Ti imaš 50.000 vrstic s po 40 stolpci, torej 2M celic. Za vsako poženeš COUNTIF čez vseh 2M celic. To je 4T operacij. I5 tu nima veze.   Pravilni postopek tukaj je, da podatke urediš in prešteješ, kolikokrat se kak podvoji. Pri čemer bo malo razlike, ali pričakuješ veliko podvajanj, malo podvajanj ali (najslabše) nekaj vmes"
    },
    {
        "role": "assistant_1",
        "message": "To nima smisla, potem mora imeti še eno matrki enake velikosti. Izvorno in nespremenjeno s podatki. Sekundarno s countif za vsakega od podatkov v tej osnovni matriki. Po mojem mnenju gre tu za neko nerazumevanje. Verjetno je že kdo prej delal na tem in se zaplezal. Kakorkoli, nekdo je izbral napačno orodje za nejasno rešitev.  Imam malo močnejšo mašino :) pa zadeva ravno tako počepne."
    },
    {
        "role": "assistant_12",
        "message": "precomputation se temu reče in ima globok smisel. 4 biljone operacij bo terjalo svoj čas, oziroma algoritem, kot ga ima, je O(n^2) (če se ne skriva notri še kakšna mina). Torej, če ne uporabi O(n logn) algoritma, je stvar časovno neuporabna in je potem vseeno, ali so podatki spremenjeni, podvojeni ali kaj tretjega."
    },
    {
        "role": "assistant_8",
        "message": "Zakaj toliko COUNTIFov?  Sigurno niso potrebni.  Sicer pa malo bolj opiši problem."
    },
    {
        "role": "assistant_1",
        "message": "@assistant_12 je 27. sep 2020 ob 10:03 izjavil:precomputation se temu reče in ima globok smisel. 4 biljone operacij bo terjalo svoj čas, oziroma algoritem, kot ga ima, je O(n^2) (če se ne skriva notri še kakšna mina). Torej, če ne uporabi O(n logn) algoritma, je stvar časovno neuporabna in je potem vseeno, ali so podatki spremenjeni, podvojeni ali kaj tretjega.  Razumem in se strinjam, pač iz te 35x45000 (1,6M) matrike se izračuna pojavnost vsakega posamičnega (!) elementa. V resnici bi se morali poiskati vsi različni elementi iz matrike, izračunati pojavnost in potem vpisati v prekomputirano tabelo (a je še potrebna?) iz te cachiranega slovarja pojavnosti. Sicer stvar ni trivialna (no, za zverzirane programerje je:) je pa vsekakor izvedljivo. Ampak do sem smo prišli šele, ko smo začeli reševati konkretno, ker bi bilo fino, da je to razlozeno na zacetku. Kakorkoli, to bi zmogel celo Excel, če bi se pravilno lotili problema, ne pa bruta-forza statistika."
    },
    {
        "role": "assistant_1",
        "message": "Se opravičujem, kosilo je bilo vmes, kava in to, torej povzetek (zadeva vzame, oh ne, nekaj sekund, s parsanjem, slovarjem in pripravo outputa), sfakeal sem osnovno matriko 35*45000 zapisov z enakomerno distribucijo 0-100 (osciliranje frekvenc okoli 15750), s skripto (niti ne v excelu), output frekvenc v tem smislu.   15858\t15804\t15783\t15665\t15903\t15928\t15907\t15907\t15652\t15717\t15498\t15815\t15622\t15511\t15498\t15887\t15772\t15394\t15394\t15888\t15894\t15768\t15661\t15580\t15630\t15815\t15712\t15643\t15758\t15968\t15643\t15780\t15815\t15661\t15702\n15782\t15521\t15772\t15968\t15634\t15854\t15606\t15749\t15715\t15834\t15572\t15709\t15772\t15762\t15839\t15614\t15860\t15709\t15785\t15760\t15789\t15772\t15782\t15887\t15511\t15511\t15606\t15394\t15702\t15888\t16002\t15716\t15630\t15695\t15867\n15772\t15804\t15875\t15887\t15903\t15901\t15901\t15762\t15509\t15712\t15572\t15906\t15906\t15789\t15928\t15572\t15780\t15860\t15770\t15945\t15557\t15906\t15652\t15939\t15772\t15834\t15719\t15839\t15882\t15768\t15903\t15893\t15907\t16002\t15815\n15901\t15649\t15719\t15800\t15762\t15638\t15712\t15903\t15717\t15906\t15860\t15630\t15772\t15800\t15785\t15498\t15815\t15939\t15649\t15906\t15716\t15789\t15709\t15717\t15719\t15875\t15745\t15606\t15854\t15585\t15749\t15882\t15887\t15836\t15665\n15786\t15712\t15717\t15770\t15778\t15585\t15725\t15875\t15775\t15715\t15770\t15712\t15882\t15557\t15652\t15668\t15712\t15760\t15782\t15750\t15623\t15786\t15834\t15887\t15887\t15782\t15875\t15750\t15907\t15664\t15766\t15804\t15778\t15758\t15854\n15580\t15606\t15771\t15772\t15778\t15772\t15800\t15815\t15772\t15580\t15665\t15768\t15668\t15709\t15766\t15768\t15770\t15975\t15770\t15585\t15715\t15394\t15691\t15945\t15716\t15765\t15691\t15664\t15511\t15939\t15749\t15702\t16002\t15702\t15907\n15634\t15719\t15557\t15887\t15643\t15745\t15893\t15719\t15793\t16002\t15975\t15597\t15775\t15672\t15765\t15939\t15789\t15585\t15668\t15749\t15778\t15778\t15893\t15834\t15709\t15498\t15858\t15975\t15834\t15867\t15766\t15780\t15772\t15793\t15854\n...\n  OP, poslji mi podatki, ti nazaj posljem prekalkulacijo, ne da se mi vsega skupaj razlagat, posiljat itn."
    },
    {
        "role": "user",
        "message": "@assistant_1 je 27. sep 2020 ob 09:32 izjavil: Imam malo močnejšo mašino :) pa zadeva ravno tako počepne.   Hvala za tvoj trud, test in nasvet :)  @assistant_12 je 27. sep 2020 ob 09:00 izjavil: Občudujem ljudi v oddelkih podpori strankam, ki morajo take nebuloze prenašati dnevno.    Hvala za tvoj nasvet in komentar. Ampak tale del zgoraj pa bi lahko izpustil... Ljudje na oddelkih za podporo strankam lahko prenašajo take nebuloze zato, ker imajo empatijo, zmožnost razmišljanja o tem da nismo vsi enaki in nekateri ste boljši v enem, drugi pa v drugem.  Sploh pa tudi ti si nekje začel s pridobivanjem znanja in verjetno si se v lajfu neštetokrat zaplezal preden si našel rešitve. Tako da tole zgražanje ni primerno.  Sem pač zabluzil in pišem nebuloze na forumu kjer ljudje iščejo nasvete drugih ljudi. Shoot me.   Drgač pa še enkrat hvala za tisti drugi del tvojega posta."
    },
    {
        "role": "user",
        "message": "@assistant_12 je 27. sep 2020 ob 10:03 izjavil:precomputation se temu reče in ima globok smisel. 4 biljone operacij bo terjalo svoj čas, oziroma algoritem, kot ga ima, je O(n^2) (če se ne skriva notri še kakšna mina). Torej, če ne uporabi O(n logn) algoritma, je stvar časovno neuporabna in je potem vseeno, ali so podatki spremenjeni, podvojeni ali kaj tretjega.   Ne bom nadaljeval z delom v Excelu, ker vam verjamem, da ni primerno orodje za moj problem. Bom poiskal drugo rešitev, nekaj ste jih že sami napisali. Odnehal pa ne bom :)  EDIT: šele zdaj sem prebral komentar od gtfo... ti pošljem"
    },
    {
        "role": "assistant_1",
        "message": "Ok, tako mimogrede, problem rešen (menda), potrebovalo je 0,657 sekunde ;)"
    },
    {
        "role": "user",
        "message": "haha hvala gtfo, ne morem verjeti :D  res je, problem rešen, kar zaprimo temo :)"
    },
    {
        "role": "assistant_1",
        "message": "Glej, da ne bo zdaj priletela kakšna jedrska bomba, izgleda že kot neki deli aktivacijske šifre. Ali pa da ne bo kak Frankenstein ozivel s tem nukleotidi ali kaj so že."
    },
    {
        "role": "user",
        "message": "hahaha :) NSA in SOVA me imata pod kontrolo"
    },
    {
        "role": "assistant_1",
        "message": "Če bi dal zraven še FURS pa bi se res težko še bolj konkretno izpostavil. :)"
    },
    {
        "role": "assistant_11",
        "message": "Proces ste optimiziral in čas zmanjšali iz 24 ur na 1 sekundo?"
    },
    {
        "role": "user",
        "message": "tako je...ne 24 ur, prej 48 ur.  Tako dober je gtfo"
    },
    {
        "role": "assistant_11",
        "message": "Odlično. Čestitam za tak rezultat.  Zanimivo, kolikokrat lahko programer in logika pohitrijo proces, v primerjavi z več hardware-a; prvo je x1000, drugo pa bolj kot ne linearno z nabavo opreme.  Za razmislit kje in na kakšen način se \"splača\" optimizirat nek process, ki traja predolgo..."
    },
    {
        "role": "assistant_1",
        "message": "Omni-vor, ok ampak me ni potrebno hvalit', sem zelo preprost človek in sem že veliko časa v tej panogi... Potrebno je primerno razložit problem nekomu, ki se mu da poslušati in ima veselje, da ga reši, ker je tole pač bilo hobi, a ne. Mimogrede, tudi Jožetu grejo nekatere zasluge s tistimi številom operacij O(n logn), kar je precej lepše formaliziral kot sem jaz. Verjamem, da se da še izboljšati performanse (ker gre za eno skripto, ne za izvršilen utility) ampak tole ni bistveno."
    },
    {
        "role": "assistant_18",
        "message": "Če se ti da, bi prosil, če lahko na kratko opišeš problem in kako si rešil zadevo (jezik, orodje ipd...), da se še drugi kaj naučimo. Hvala."
    },
    {
        "role": "assistant_1",
        "message": "Narejeno je v html za uporabnikov input in javascript za procesiranje, iz Excela vzames vrednosti (copy/paste), razrežeš tekstualni input v matriko, uporabiš slovar (vrednost, frekvenca), iteriraš vse vrednosti, ažuriraš števec, potem zgeneriraš (in skopiraš v Excel) matriko iste strukture kot vhodna, samo namesto da zapišeš vrednost, uporabiš frekvenco, ki jo prebere iz slovarja. Glavna stvar je - slovar s hitrim iskanjem, da se izogneš odvečnemu izvajanju formule. Vrstni red ni pomemben. Vsak sprufan programer pa ve ali bi moral vdeti, kaj pomeni O(n logn) :-)"
    },
    {
        "role": "assistant_18",
        "message": "@assistant_1 je 27. sep 2020 ob 16:00 izjavil: Glavna stvar je - slovar s hitrim iskanjem, da se izogneš odvečnemu izvajanju formule.   Tu sem zdaj zaštekal, v čem je bil problem. Sicer si prej že zgoraj napisal, samo mi ni “potegnilo” takrat. Hvala za razlago."
    },
    {
        "role": "assistant_14",
        "message": "potrebovalo je 0,657 sekundeHehe, sem rekel nekaj 100 milisekund max."
    },
    {
        "role": "assistant_6",
        "message": "@assistant_1 je 27. sep 2020 ob 16:00 izjavil:Narejeno je v html za uporabnikov input in javascript za procesiranje, iz Excela vzames vrednosti (copy/paste), razrežeš tekstualni input v matriko, uporabiš slovar (vrednost, frekvenca), iteriraš vse vrednosti, ažuriraš števec, potem zgeneriraš (in skopiraš v Excel) matriko iste strukture kot vhodna, samo namesto da zapišeš vrednost, uporabiš frekvenco, ki jo prebere iz slovarja. Glavna stvar je - slovar s hitrim iskanjem, da se izogneš odvečnemu izvajanju formule. Vrstni red ni pomemben. Vsak sprufan programer pa ve ali bi moral vdeti, kaj pomeni O(n logn) :-)   Se pravi smo iskal funkcijo frequency v Excelu."
    },
    {
        "role": "assistant_1",
        "message": "Menda pa res, zanimivo; op - preveri, če je to dovolj za tvoje potrebe. V vprašanjih se je dobro izogniti namigom za neke rešitve, sploh, če niso dodelane. Najbrž smo res prišli od najema virtualk preko skripte nazaj v Excel. Skripto bom pač (posredno) dodal v svoj online repositorij besedilnih storitev."
    },
    {
        "role": "assistant_1",
        "message": "@assistant_6, sem šel preskušat - FREQUENCY je sicer podobno, vendar ne rezultira v enakovredni matrike:   Vhodni podatki\t\t\tŽelen rezultat\t\t\n0\t1\t0\t\t6\t1\t6\n3\t2\t0\t\t2\t3\t6\n3\t2\t2\t\t2\t3\t3\n0\t0\t0\t\t6\t6\t6\n  Če pa ti uspe isto doseči s FREQUENCY, se pa dam podučiti."
    },
    {
        "role": "assistant_6",
        "message": "Sem sprobal samo na phone Excelu. Frekvence držio, potem sledi samo replace na podane vrednosti če jih hočeš v danem formatu(matriki)."
    },
    {
        "role": "assistant_1",
        "message": "Ja, izračun frekvenc drži, ampak rešitve out-of-the-box ni videti za potrebe op... In search in replace za (opjevih 35x45500) 1,6M zapisov in to vertikalno v enem stolpcu... Vprašanje... Najbrž si samo domišljam ampak skripta se mi zdi vseeno lažji pristop, ker vse sama uredi (predvsem ta search/replace), je pa copy/paste vse matrike iz in nazaj v excel ostane uporabniku v kratek čas. Sicer se tudi skripto se pretvori v vba/excel v FREQUENCYTOMATRIX(), re, če se izkaže potreba. In motivacija 🤑🤑🤑🤑🤑 :)"
    },
    {
        "role": "assistant_6",
        "message": "Lohk da je skripta hitrejša. Preden nisi opisal rešitve mi sploh ni bilo čisto jasno, kaj hoče. Vse skupaj je zvenelo skrivnostno kot da analizira radijske valove od alienov.  Replace pa itak jemlje samo prve unique elemente. Meni je tole bolj zanimivo kot vaja v slogu. A vseeno ne je malo zaskrbelo da to Excel nebi rebavil če ne gre za križ kraž skliče. Saj je mestoma butast ampak večkrat smo uporabniki v spregi."
    },
    {
        "role": "assistant_6",
        "message": "Upam na bogato nagrado."
    },
    {
        "role": "assistant_5",
        "message": "Mogoče bi uporabil kakšen Octave, bolj primeren za obdelovanje velikih količin podatkov, sploh v matrikah itd. - nisem bral cele teme, samo ideja. Je pa res, da je potrebno vsaj neko čisto osnovno znanje programiranja."
    },
    {
        "role": "user",
        "message": "@assistant_6 je 28. sep 2020 ob 06:46 izjavil:Se pravi smo iskal funkcijo frequency v Excelu.   Frequency sem tudi že sprobal čisto na začetku in ni bilo ok, se pa ne spomnim več zakaj ne, ker sem že toliko stvari preizkusil :) Bom ob šansi preveril kaj je bil že razlog, da sem opustil freq.  edit: med tednom malo težje spremljam forum, zato zamuda pri odgovoru."
    },
    {
        "role": "assistant_19",
        "message": "@assistant_5 je 28. sep 2020 ob 22:40 izjavil:Mogoče bi uporabil kakšen Octave, bolj primeren za obdelovanje velikih količin podatkov, sploh v matrikah itd. - nisem bral cele teme, samo ideja. Je pa res, da je potrebno vsaj neko čisto osnovno znanje programiranja. Octave je najpočasnejša možna izbira, še R je hitrejši. Če že kaj, potem Julia."
    },
    {
        "role": "assistant_1",
        "message": "No, za zaključek, nova uporabniška Excel funkcija \"=FREQUENCYMATRIX(SourceRange,TargetRange)\" vrača (izgleda) povsem enak rezultat direktno v excel tabeli, vendar je malo počasneje, potrebuje slabe 4 sekunde  > UniquesCount: 1591590 values of 4556 unique in 734 ms  > FrequencyMatrix, 4556 uniques: 1591590 values in 3563 ms  Ok, to je to na to temo, kar se tiče mene, mi je bila všeč ideja z virtualkami :)"
    },
    {
        "role": "assistant_6",
        "message": "@assistant_1 je 29. sep 2020 ob 09:39 izjavil:No, za zaključek, nova uporabniška Excel funkcija \"=FREQUENCYMATRIX(SourceRange,TargetRange)\" vrača (izgleda) povsem enak rezultat direktno v excel tabeli, vendar je malo počasneje, potrebuje slabe 4 sekunde  > UniquesCount: 1591590 values of 4556 unique in 734 ms  > FrequencyMatrix, 4556 uniques: 1591590 values in 3563 ms  Ok, to je to na to temo, kar se tiče mene, mi je bila všeč ideja z virtualkami :)  Rajtam, da je še zmer hitrej kot najem virtualke."
    },
    {
        "role": "user",
        "message": "@assistant_1 je 29. sep 2020 ob 09:39 izjavil:No, za zaključek, nova uporabniška Excel funkcija \"=FREQUENCYMATRIX(SourceRange,TargetRange)\" vrača (izgleda) povsem enak rezultat direktno v excel tabeli, vendar je malo počasneje, potrebuje slabe 4 sekunde  > UniquesCount: 1591590 values of 4556 unique in 734 ms  > FrequencyMatrix, 4556 uniques: 1591590 values in 3563 ms  Ok, to je to na to temo, kar se tiče mene, mi je bila všeč ideja z virtualkami :)   OK eat me alive, ker sem dal idejo z virtualkami :P Je pač obstajala neprimerno boljša rešitev za katero nisem vedel.  FREQUENCYMATRIX sicer ne znam pognat v Excelu, hitro googlanje najde samo v povezavi s pythonom...sem pa probal Frequency v Excelu in mi nekaj ne gre-verjetno isti problem kot takrat, s katerim sem se srečal ko sem prvič poskušal...neznanje.  Bom že zguglal rešitev do konca. Zdaj vsaj vem kje jo iskat glede na to, da je gtfo potrdil, da deluje za moj primer."
    },
    {
        "role": "assistant_1",
        "message": "FrequencyMatrix() je nova uporabniško definirana funkcija kot razširitev za Excel, zaenkrat je samo prototip, ni še del excela, bo pa verjetno kak addin. Zadeva pa deluje, je pa vba precej počasen. I shit you not, tiste meritve so na osnovi poslanih podatkov, 1.6M. Če e se bo zadeva tudi prijela, boš svetovalec za virtualske kalkulacije :)"
    },
    {
        "role": "user",
        "message": "Kako si pa ti prišel do tega? Kot kak developer, ker maš ekstra dostop do beta verzij?"
    },
    {
        "role": "assistant_6",
        "message": "@user je 30. sep 2020 ob 07:50 izjavil:Kako si pa ti prišel do tega? Kot kak developer, ker maš ekstra dostop do beta verzij?  Sam je spisal. Frequency je vzel za dictionary v VBA makru. Z slovarjem je potem pomenjal vrednosti v ciljni tabeli. Če se malo pomatraš ti mora ratat."
    },
    {
        "role": "assistant_1",
        "message": "Joj no, @user, addin zaenkrat ni uraden iz M$ Office marketplace, če pa bo, pa super. @assistant_6, ja, načeloma drži, je pa potrebno poznati delovanje funkcij malo boljše ampak res ni ničesar, kar ni možno izguglati, hehe. Navsezadnje gre za branje, obdelavo in zapis 1,6M vrednosti v slabih 4 sekundah, v eni sami funkciji, se pravi nekje 0,4M na sekundo. Domnevam, da je to sprejemljiva hitrost, če pa ni, pa tough luck."
    },
    {
        "role": "user",
        "message": "OK."
    }
]