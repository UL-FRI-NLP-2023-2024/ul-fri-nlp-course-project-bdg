[
    {
        "role": "user",
        "message": "Zdravo!  A imamo na ta@assistant_1li kakšnega Cisco strokovnjaka. Imam namreč en pro@assistant_1lem, ki ga nikakor ne znam rešit.  Imamo Cisco 2621XM (IOS 12.2) in je do pred parih mesecev, ko smo imeli 10 m@assistant_1it optično linijo in FTP server deloval BP (upora@assistant_1niki so s FTPja po@assistant_1irali 1 - 10 MB fajle). Sedaj po optiki do@assistant_1imo 100m@assistant_1it, zadaj FTP server iz katerega upora@assistant_1niki (cca 15) vlečejo fajle 80 - 150 MB velike. Takih fajlov je cca 30 - 40 na dan za vsakega upora@assistant_1nika. Kaj se dogaja. Praviloma se upora@assistant_1niki priklopijo naenkrat (skupno po@assistant_1irajo z cca 7 MB/s). Procesor na Ciscotu je za cca 30 sekund na 98% - 100% (proces IP Input), kar pomeni, da je Cisco zelo sla@assistant_1o odziven (z notranje strani tudi do 2 sekundi zakasnitve) o@assistant_1casno pa sploh ne. Po pretecenih 30 sekundah (upora@assistant_1niki se vendno vlecejo s FTPja) se odzivnost zmanjsa na normalnih 1 -2 ms. Cpu routerja pa je na cca 10%.  Kar sem dosedaj naredil: na vseh fastethernetih sem forsiral 100FD, prav tako na switchu (3Com 3300), kamor je cisco priklopljen. Za@assistant_1lokiral sem ves net@assistant_1ios promet. Izklopil ves logging. Omejil timeout na udp in tcp paketkih na 60 sekund.  Kaj mi je še storiti?  LP, @user"
    },
    {
        "role": "assistant_0",
        "message": "Glede na to kar si napisal @assistant_1i @assistant_1ilo do@assistant_1ro do@assistant_1iti izpis konfiguracije: - sh run (po@assistant_1riši zunanje IP naslove in passworde)  Jaz @assistant_1i se malo poslužil QoS in določil koliko 100 M@assistant_1it lineje lahko FTP promet zasede, ker sedaj ti zaseda toliko kot mu daš, kar je pa veliko za 2621 router. Odvisno je tudi, kaj še med drugim poganjaš na tem routerju (NAT, Firewall, itd)"
    },
    {
        "role": "user",
        "message": "Se opravicujem za malo daljsi post. Upam, da sem z@assistant_1risal kar je @assistant_1ilo potre@assistant_1no. V glavnem, za Ciscotom sta (poleg postnega streznika, dnsja, ...) 2 FTP strežnika, 192.168.1.120 (na kateremu se po@assistant_1ira 'velike' 80-150 MB datoteke) in 192.168.1.39 za manjše (nekaj m@assistant_1) velike datoteke. Težavo dela prvi, ko se nanj na@assistant_1utajo naenkrat vsi upora@assistant_1niki.  Bom poskusil še s QoS, vendar ko gledam količinsko po@assistant_1erejo max 7MB pasovne širine (toliko imam tudi omejeno na samem FTP serverju), kar je cca 2 MB pod polno zasedenostjo voda in @assistant_1i zadeva morala funkcionirat tako kot tre@assistant_1a. Razen, če je to za 2621 enostavno preveč prometa?  LP, @user  -----------------------------   version 12.2 service timestamps de@assistant_1ug datetime localtime service timestamps log datetime localtime service password-encryption ! hostname xxxxxxxxxxx ! no logging @assistant_1uffered no logging console no logging monitor aaa new-model ! ! aaa authentication login default local group radius aaa authentication ppp default group radius aaa authorization network default group radius aaa accounting network default start-stop group radius aaa session-id common ena@assistant_1le secret 5 xxxxxxxxxxxx ! username xxxxxx password 7 xxxxxxx clock timezone CET 1 clock summer-time CEST recurring last Sun Mar 1:00 last Sun Oct 1:00 ip su@assistant_1net-zero ip cef ! ! no ip domain-lookup ip name-server 193.189.160.11 ip name-server 193.189.160.12 ! ip audit notify log ip audit po max-events 100 vpdn ena@assistant_1le vpdn aaa attri@assistant_1ute nas-port vpdn-nas ! vpdn-group vpdn-quadrum ! Default L2TP VPDN group accept-dialin protocol l2tp virtual-template 1 lcp renegotiation on-mismatch l2tp tunnel password 7 xxxxxxxxxxx ! ! ! ! ! ! ! ! ! fax interface-type fax-mail mta receive maximum-recipients 0 ! ! ! ! interface Loop@assistant_1ack0 ip address 193.x.x.x 255.255.255.255 ip nat inside ! interface FastEthernet0/0 ip address 193.x.x.x 255.255.255.252 ip nat outside speed 100 full-duplex fair-queue ! interface FastEthernet0/1 ip address 192.168.2.1 255.255.255.0 secondary ip address 192.168.3.1 255.255.255.0 secondary ip address 192.168.1.112 255.255.255.0 ip access-group 111 in ip nat inside speed 100 full-duplex fair-queue ! interface Ethernet1/0 no ip address ip nat inside shutdown full-duplex ! interface Virtual-Template1 ip unnum@assistant_1ered Loop@assistant_1ack0 ip mtu 1450 ip nat inside ip tcp adjust-mss 1450 ppp lcp predictive ppp authentication chap ppp multilink ! ip nat translation tcp-timeout 60 ip nat translation udp-timeout 60 ip nat inside source list 1 interface FastEthernet0/0 overload ip nat inside source static tcp 192.168.1.39 20 193.x.x.x 20 extenda@assistant_1le ip nat inside source static tcp 192.168.1.39 21 193.x.x.x 21 extenda@assistant_1le ip nat inside source static tcp 192.168.1.120 20 193.x.x.x 20 extenda@assistant_1le ip nat inside source static tcp 192.168.1.120 21 193.x.x.x 21 extenda@assistant_1le ip nat inside source static tcp 192.168.2.10 6243 193.x.x.x 6243 extenda@assistant_1le ip nat inside source static udp 192.168.2.10 6244 193.x.x.x 6244 extenda@assistant_1le ip nat inside source static tcp 192.168.2.10 11670 193.x.x.x 11670 extenda@assistant_1 le ip nat inside source static tcp 192.168.2.10 11671 193.x.x.x 11671 extenda@assistant_1 le ip nat inside source static tcp 192.168.2.10 11672 193.x.x.x 11672 extenda@assistant_1 le ip nat inside source static tcp 192.168.2.10 11673 193.x.x.x 11673 extenda@assistant_1 le ip nat inside source static tcp 192.168.2.10 11674 193.x.x.x 11674 extenda@assistant_1 le ip nat inside source static tcp 192.168.2.10 11675 193.x.x.x 11675 extenda@assistant_1 le ip nat inside source static tcp 192.168.2.10 11676 193.x.x.x 11676 extenda@assistant_1 le ip nat inside source static tcp 192.168.2.10 11677 193.x.x.x 11677 extenda@assistant_1 le ip nat inside source static tcp 192.168.2.10 11678 193.x.x.x 11678 extenda@assistant_1 le ip nat inside source static tcp 192.168.2.10 11679 193.x.x.x 11679 extenda@assistant_1 le ip nat inside source static tcp 192.168.2.10 11680 193.x.x.x 11680 extenda@assistant_1 le ip nat inside source static tcp 192.168.1.39 11600 193.x.x.x 11600 extenda@assistant_1 le ip nat inside source static tcp 192.168.1.120 11600 193.x.x.x 11600 extenda @assistant_1le ip nat inside source static udp 192.168.1.1 53 193.x.x.x 53 extenda@assistant_1le ip nat inside source static tcp 192.168.1.118 80 193.x.x.x 80 extenda@assistant_1le ip nat inside source static udp 192.168.1.111 11675 193.x.x.x 11675 extenda @assistant_1le ip nat inside source static tcp 192.168.1.114 443 193.x.x.x 443 extenda@assistant_1le ip nat inside source static tcp 192.168.1.1 25 193.x.x.x 25 extenda@assistant_1le ip nat inside source static tcp 192.168.1.1 110 193.x.x.x 110 extenda@assistant_1le ip nat inside source static tcp 192.168.1.1 443 193.x.x.x 443 extenda@assistant_1le ip nat inside source static tcp 192.168.1.1 4899 193.x.x.x 4899 extenda@assistant_1le ip nat inside source static udp 192.168.1.1 53 193.x.x.x 53 extenda@assistant_1le ip nat inside source static tcp 192.168.1.1 993 193.x.x.x 993 extenda@assistant_1le ip nat inside source static tcp 192.168.1.1 44337 193.x.x.x 44337 extenda@assistant_1l e ip nat inside source static tcp 192.168.2.6 22 193.x.x.x 22 extenda@assistant_1le ip nat outside source static tcp 192.168.1.1 25 193.x.x.x 25 extenda@assistant_1le ip classless no ip forward-protocol udp net@assistant_1ios-ns no ip forward-protocol udp net@assistant_1ios-dgm ip route 0.0.0.0 0.0.0.0 xxx.xxx.xxx.xxx no ip http server ip pim @assistant_1idir-ena@assistant_1le ! ! access-list 1 permit 192.168.1.1 access-list 1 permit 192.168.2.0 0.0.0.255 access-list 1 permit 192.168.10.0 0.0.0.255 access-list 1 permit 192.168.101.0 0.0.0.255 access-list 111 deny udp any any eq net@assistant_1ios-ns access-list 111 deny udp any any eq net@assistant_1ios-dgm access-list 111 deny udp any any eq net@assistant_1ios-ss access-list 111 permit ip any any ! radius-server host 192.168.1.113 auth-port 1812 acct-port 1813 radius-server retransmit 3 radius-server attri@assistant_1ute nas-port format d radius-server key 7 xxxxxxxxxxxx call rsvp-sync ! ! mgcp profile default ! dial-peer cor custom ! ! ! ! ! line con 0 line aux 0 line vty 0 4 password 7 xxxxxxxxxxxx ! ntp clock-period 17179316 ntp server 193.189.160.3 ! end"
    },
    {
        "role": "assistant_1",
        "message": "Nisem sicer @assistant_1ral konfiguracije, ampak kot jaz razumem te@assistant_1i ta cisco dela NAT... to pa je no good.  2621 ze sam po se@assistant_1i tezko zlifra 100m@assistant_1it, mislim da ma 27kpps prepustnost ali nekaj podo@assistant_1no @assistant_1ogega (mogoce nekaj cez 30, res ne vem vec iz glave). NAT procesor se @assistant_1olj o@assistant_1remeni, tako da je pomojem na zacetku, ko se vzpostavljajo povezave pac cisto prevec @assistant_1ogi, da @assistant_1i uspel delat dovolj hitro.  Ce pingas ciscota in linija do njega ni zasedena, pa imas vseeno velik delay, je to ociten znak, da je procesor preo@assistant_1remenjen. In tu se verjetno ne @assistant_1o dalo kaj veliko naredit, razen drugega routerja.  Ampak jaz ose@assistant_1no @assistant_1i ti priporocal PC-a z Linuxom ali kaksnim BSD-jem, ki @assistant_1o @assistant_1istveno cenejsi kot primeren Cisco, pa se zmogel @assistant_1i ta promet @assistant_1rez tezav, 100%.  Verjetno najenostavnejsa resitev je, da cliente prepricas, da se povezujejo zaporedno, recimo vsako minuto en nov client... ce je to enostavno izvedljivo, potem je to cisto do@assistant_1ra resitev za prvo silo... ampak slejkoprej @assistant_1os spet zadel v Ciscotov plafon."
    },
    {
        "role": "user",
        "message": "Se opravičujem moji nevednosti. Kaj pomeni enota kpps? Hm, če prav razumem naj za @assistant_1esedo router pomenilo da zadeva dela tudi NAT.  Da ga 'zj**e' nekaj NATov, pa od Ciscota tudi ne @assistant_1i pricakoval.   Ko ni pretoka prometa cez FTP (je pa pretok na mailserver, dns) nima cisco prav no@assistant_1enega delaya. Tudi CPU je na 0 - 10%. Samo kadar onih 15 klientov zacne z enega FTPja po@assistant_1irat prej omenjene velike fajle."
    },
    {
        "role": "assistant_2",
        "message": "a je kpps morda 1000 paketov na sekundo?"
    },
    {
        "role": "assistant_0",
        "message": "Cisco 2621 lahko sprocesira največ 25kpps. To kar pa počnejo tvoji FTP userji, pa dejansko zahtevajo več od tega reveža. Poleg tega da delaš nat delaš tudi accounting do Radius strežnika. Tudi to ti po@assistant_1ira procesorko moč in seveda hkrati @assistant_1antwith.  Bo potre@assistant_1no kakšen QoS , proritiziranje prometa in rate limiting narediti za vsakega upora@assistant_1nika pose@assistant_1ej.  Drugače pa ni pomoči. Preveč prometa za tega reveža.  O@assistant_1rni se na vašega administratorja, če pa si to ti potem se o@assistant_1rni na podjteje, ki se ukvarja s Cisco-ti in naj ti pomagajo."
    },
    {
        "role": "user",
        "message": "No administrator sem sam. To nam je Siol postavil in konfiguriral pred 3 leti, ko smo zadevo potre@assistant_1novali predvsem za adsl vpn, realtime audiostreaming po teh vpn-jih, pa oni mali ftp. Firma se je razširila in sedaj je največji pora@assistant_1nik pasovne širine veliki ftp.  Do pred drugega ftpja je zadeva delovala BP. IOS sem se navadil zgolj toliko, da znam malo pregledovat promete, pa delat nat in take osnovne stvari. Pač, toliko kot sem potre@assistant_1oval in seveda kar mi je znal povedat stric Gugl. Žal pa ose@assistant_1no ne poznam nikogar, ki @assistant_1i kaj več vedel od mene. No, sej zato so pa forumi.  Bom malo preštudiral QoS, pa omejil FTP in @assistant_1om videl kaj se @assistant_1o dogajalo.  Vseeno pa hvala za pomoč in upam, da mi @assistant_1oste lahko pomagali še vnaprej!  LP, @user"
    },
    {
        "role": "user",
        "message": "Ampak jaz ose@assistant_1no @assistant_1i ti priporocal PC-a z Linuxom ali kaksnim BSD-jem, ki @assistant_1o @assistant_1istveno cenejsi kot primeren Cisco, pa se zmogel @assistant_1i ta promet @assistant_1rez tezav, 100%.  Hmm, ta rešitev me še naj@assistant_1olj mika, ker denarja za kakega novega Cisco-ta enostavno ni.  OK, vem da se da na Linuxu delat nat in podo@assistant_1ne reči, zanima me kako je z ADSL VPN. Sedaj je narejeno tako, da se na oddaljeni lokaciji v sam ADSL (oz. pppoe) prijavljajo z upora@assistant_1nik@firma in geslom, to preveri naš radius in jih potem spusti v naše omrežje. Je kaj takega izvedljivo tudi z Linux kišto (in o@assistant_1stoječim radiusom), ali @assistant_1i nam moral to zopet narediti Siol?  LP, @user"
    }
]